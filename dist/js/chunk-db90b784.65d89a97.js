(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-db90b784"],{"62af":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e._self._c;return t("div",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addDialogVisible()}}},[e._v("资料上传")]),t("el-dialog",{attrs:{title:"新增上传",visible:e.dialogFormVisible,"show-close":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("h2",{staticStyle:{textAlign:"center",marginBottom:"10px"}},[e._v("资料上传")]),t("el-form",{attrs:{"label-width":"120px"}},[t("el-form-item",{attrs:{label:"获奖人",prop:"people"}},[t("el-input",{attrs:{placeholder:"请填写获奖人"},on:{blur:e.getPersonId},model:{value:e.fileData.name,callback:function(t){e.$set(e.fileData,"name",t)},expression:"fileData.name"}})],1),t("el-form-item",{attrs:{label:"奖励名称",prop:"title"}},[t("el-input",{attrs:{placeholder:"请填写具体名称"},model:{value:e.fileData.pPriceName,callback:function(t){e.$set(e.fileData,"pPriceName",t)},expression:"fileData.pPriceName"}})],1),t("el-form-item",{staticStyle:{marginTop:"10px"},attrs:{label:"奖励等级"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择奖励等级"},model:{value:e.fileData.pLevel,callback:function(t){e.$set(e.fileData,"pLevel",t)},expression:"fileData.pLevel"}},e._l(e.levOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"添加文件"}},[t("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"auto-upload":!1,"http-request":e.fileUpload,"file-list":e.fileList,"on-remove":e.handleRemove,action:"#",drag:"",multiple:""}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("支持PDF,Word等文件")])])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.dialogVisible()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveAdd()}}},[e._v("确 定")])],1)],1),t("el-button",{staticStyle:{marginLeft:"10px"},attrs:{size:"small"},on:{click:function(t){return e.alterReward()}}},[e._v("修改")]),t("el-dialog",{attrs:{title:"修改信息",visible:e.alterFormVisible,"show-close":!1},on:{"update:visible":function(t){e.alterFormVisible=t}}},[t("h2",{staticStyle:{textAlign:"center"}},[e._v("修改信息")]),t("el-form",{attrs:{"label-width":"120px"}},[t("el-form-item",{attrs:{label:"获奖人",prop:"people"}},[t("el-input",{attrs:{placeholder:"请填写获奖人"},on:{blur:e.getPersonId},model:{value:e.fileData.name,callback:function(t){e.$set(e.fileData,"name",t)},expression:"fileData.name"}})],1),t("el-form-item",{attrs:{label:"奖励名称",prop:"title"}},[t("el-input",{attrs:{placeholder:"请填写具体名称"},model:{value:e.fileData.pPriceName,callback:function(t){e.$set(e.fileData,"pPriceName",t)},expression:"fileData.pPriceName"}})],1),t("el-form-item",{staticStyle:{marginTop:"10px"},attrs:{label:"奖励等级"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择奖励等级"},model:{value:e.fileData.pLevel,callback:function(t){e.$set(e.fileData,"pLevel",t)},expression:"fileData.pLevel"}},e._l(e.levOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"添加文件"}},[t("el-upload",{ref:"update",staticClass:"upload-demo",attrs:{"auto-upload":!1,"http-request":e.fileUpload,"file-list":e.fileList,"on-remove":e.handleRemove,action:"#",drag:"",multiple:""}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip",staticStyle:{color:"red"},attrs:{slot:"tip"},slot:"tip"},[e._v("支持PDF,Word等文件")])])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.alterClose()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.saveUpdate()}}},[e._v("确 定")])],1)],1),t("el-button",{staticStyle:{marginLeft:"10px"},attrs:{type:"danger",size:"small"},on:{click:e.removeData}},[e._v("删除")]),[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[t("el-form-item",{staticStyle:{marginTop:"10px"},attrs:{label:"获奖人员"}},[t("el-input",{attrs:{placeholder:"请输入获奖人名",size:"small"},model:{value:e.searchMsg.searchPerson,callback:function(t){e.$set(e.searchMsg,"searchPerson",t)},expression:" searchMsg.searchPerson"}})],1),t("el-form-item",{staticStyle:{marginTop:"10px"},attrs:{label:"获奖名称"}},[t("el-input",{attrs:{placeholder:"请输入获奖名称",size:"small"},model:{value:e.searchMsg.searchReward,callback:function(t){e.$set(e.searchMsg,"searchReward",t)},expression:" searchMsg.searchReward"}})],1),t("el-form-item",[t("el-button",{staticStyle:{marginTop:"14px"},attrs:{type:"primary",size:"small"},on:{click:e.searchReward}},[e._v("查询")]),t("el-button",{staticStyle:{marginLeft:"10px"},attrs:{size:"small"},on:{click:e.reset}},[e._v("查询所有")])],1)],1)],t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.rewardData,border:!0},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{label:"勾选",width:"55px",type:"selection",align:"center"}}),t("el-table-column",{attrs:{prop:"name",label:"获奖人",align:"center"}}),t("el-table-column",{attrs:{prop:"ppriceName",label:"获奖名称",align:"center"}}),t("el-table-column",{attrs:{prop:"puploadTime",label:"日期",align:"center"}})],1),t("el-pagination",{attrs:{layout:"prev,pager,next,jumper",total:e.total,"current-current":e.p.current,"page-size":e.p.number},on:{"update:currentCurrent":function(t){return e.$set(e.p,"current",t)},"update:current-current":function(t){return e.$set(e.p,"current",t)},"current-change":e.handleCurrentChange}})],2)},i=[],r=(a("14d9"),a("85fe"));const s=e=>{let{current:t,number:a}=e;return Object(r["a"])({url:"http://175.178.83.49:9108/servicefile/prices/price/selectByPage",params:{current:t,number:a},method:"post"})},o=e=>Object(r["a"])({url:"http://175.178.83.49:9108/servicePerson/pricePersons/person/selectByName",params:{name:e},method:"post"}),c=e=>Object(r["a"])({url:"http://175.178.83.49:9108/servicefile/prices/price/selectById",params:{pid:e},method:"get"}),n=e=>{let{id:t,name:a,pPriceName:l,pLevel:i}=e;return Object(r["a"])({url:"http://175.178.83.49:9108/servicefile/prices/price/save",params:{id:t,name:a,pPriceName:l,pLevel:i},method:"post"})},p=e=>{let{id:t,name:a,pPriceName:l,pid:i,pLevel:s}=e;return Object(r["a"])({url:"http://175.178.83.49:9108/servicefile/prices/price/update",params:{id:t,name:a,pid:i,pPriceName:l,pLevel:s},method:"post"})},d=e=>Object(r["a"])({url:"http://175.178.83.49:9108/servicefile/Pricefiles/priceFile/insertfile",data:e,method:"post"}),h=e=>Object(r["a"])({url:"http://175.178.83.49:9108/servicefile/prices/price/delete",params:{pid:e},method:"post"}),m=(e,t)=>Object(r["a"])({url:"http://175.178.83.49:9108/servicefile/prices/price/selectByNameOrPriceName",params:{name:e.searchPerson,priceName:e.searchReward,current:t.current,number:t.number},method:"post"});var u={name:"reward",data(){return{fileData:{id:"",name:"",pPriceName:"",pLevel:""},fileList:[],dialogFormVisible:!1,alterFormVisible:!1,multipleSelection:[],levOptions:[{value:"省级",label:"省级"},{value:"国家级",label:"国家级"}],searchMsg:{searchReward:null,searchPerson:null},rewardData:[],p:{current:1,number:6},total:0,flag:!0}},computed:{pid(){return this.$store.state.reward.pid}},watch:{searchMsg:{deep:!0,handler(e,t){this.p.current=1}}},methods:{async fileUpload(e){const{file:t}=e,a=new FormData;a.append("file",t),a.append("pid",this.fileData.id);try{await d(a);this.fileList=[]}catch(l){alert(l.message)}},handleRemove(e,t){console.log(e,t)},handleCurrentChange(e){this.p.current=e,this.flag?this.getRewardData():this.searchReward()},handleSelectionChange(e){let t=[];e.forEach(e=>{t.push(e.pid)}),this.$store.dispatch("reward/SelectionChange",t)},async alterReward(){if(0===this.pid.length)alert("请勾选修改的内容");else if(1===this.pid.length){this.alterFormVisible=!0;const e=await c(this.pid[0]);this.fileData.name=e.data.name,this.fileData.pLevel=e.data.plevel,this.fileData.pPriceName=e.data.ppriceName}else this.pid.length>1&&alert("至多修改一条信息")},dialogVisible(){this.fileData.id="",this.fileData.name="",this.fileData.pPriceName="",this.fileData.pLevel="",this.dialogFormVisible=!1},addDialogVisible(){this.fileData.id="",this.fileData.name="",this.fileData.pPriceName="",this.fileData.pLevel="",this.dialogFormVisible=!0},alterClose(){this.fileData.id="",this.fileData.name="",this.fileData.pPriceName="",this.fileData.pLevel="",this.alterFormVisible=!1},async getRewardData(){try{const e=await s(this.p);console.log(e),e.data.prices.forEach(e=>{e.puploadTime=e.puploadTime.slice(0,10)}),this.rewardData=e.data.prices,this.total=e.data.total}catch(e){alert(e.message)}},async getPersonId(){if(this.fileData.name){let e=await o(this.fileData.name);e.data.length?this.fileData.id=e.data[0].id:(this.fileData.name="",alert("当前系统无数据，请输入正确姓名"))}},async saveAdd(){if(this.fileData.name&&this.fileData.pPriceName.trim()&&this.fileData.pLevel)try{await n(this.fileData);this.$refs.upload.submit(),this.fileData.id="",this.fileData.name="",this.fileData.pPriceName="",this.fileData.pLevel="",this.dialogFormVisible=!1,this.getRewardData(),alert("上传成功")}catch(e){alert("上传连接失败")}else alert("请输入完整的获奖信息")},async saveUpdate(){if(this.fileData.name&&this.fileData.pPriceName.trim()&&this.fileData.pLevel){const e={id:this.fileData.id,pid:this.pid[0],name:this.fileData.name,pPriceName:this.fileData.pPriceName,pLevel:this.fileData.pLevel};await p(e);this.$refs.update.submit(),this.fileData.id="",this.fileData.name="",this.fileData.pPriceName="",this.fileData.pLevel="",this.alterFormVisible=!1,this.getRewardData(),alert("修改成功")}else alert("请输入完整的获奖信息")},async removeData(){if(0!==this.pid.length)try{for(let e=0;e<this.pid.length;e++){await h(this.pid[e])}this.getRewardData()}catch(e){}else alert("未选择任何项")},async searchReward(){if(this.searchMsg.searchReward||this.searchMsg.searchPerson)try{let e=await m(this.searchMsg,this.p);e.data.prices.forEach(e=>{e.puploadTime=e.puploadTime.slice(0,10)}),this.searchMsg.searchPerson=null,this.searchMsg.searchReward=null,this.rewardData=e.data.prices,this.total=e.data.total,this.flag=!1}catch(e){alert(e.message)}else alert("请输入查询内容")},reset(){this.searchMsg.searchPerson=null,this.searchMsg.searchReward=null,this.p.current=1,this.flag=!0,this.getRewardData()}},created(){this.getRewardData()}},f=u,b=(a("fbbc"),a("2877")),v=Object(b["a"])(f,l,i,!1,null,"7edcda75",null);t["default"]=v.exports},eee8:function(e,t,a){},fbbc:function(e,t,a){"use strict";a("eee8")}}]);