{"remainingRequest":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\src\\pages\\filedata\\fileDataGainPic.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\src\\pages\\filedata\\fileDataGainPic.vue","mtime":1711121721550},{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\babel.config.js","mtime":1710918909587},{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710918915895},{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\babel-loader\\lib\\index.js","mtime":1710918914227},{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710918915895},{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\vue-loader\\lib\\index.js","mtime":1710918931244}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly/kv67mlLnogIV0emggMjAyNC4zLjEKaW1wb3J0IHsgcmVxUGljVHlwZSwgcmVxR2V0QWxsUGljLCByZXFHZXRUeXBlUGljLCByZXFSZW1vdmVQaWMgfSBmcm9tICJAL2FwaS9maWxlRGF0YS9nYWluUGljIjsKaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2ZpbGVEYXRhR2FpblBpYycsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIEFkZFBpY3R1cmVWaXNpYmxlOiBmYWxzZSwKICAgICAgLy/mt7vliqDlr7nor53moYbmmK/lkKbmiZPlvIAKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIC8v5Zu+54mH6aKE6KeI5pS+5aSn5Yqf6IO9CiAgICAgIGZpbGVEYXRhOiB7CiAgICAgICAgdGl0bGU6ICIiLAogICAgICAgIHR5cGU6ICIiCiAgICAgIH0sCiAgICAgIC8v6L2u5pKt5Zu+5L+h5oGvCiAgICAgIHNlYXJjaFR5cGVWYWx1ZTogIiIsCiAgICAgIC8v5p+l6K+i5Y+C5pWwCiAgICAgIGRpYWxvZ0ltYWdlVXJsOiAiIiwKICAgICAgLy/lm77niYdVUkwKICAgICAgdHlwZU9wdGlvbjogW10sCiAgICAgIGxpc3Q6IFtdLAogICAgICBwOiB7CiAgICAgICAgY3VycmVudDogMSwKICAgICAgICBudW1iZXI6IDQKICAgICAgfSwKICAgICAgdG90YWw6IDAsCiAgICAgIGZsYWc6IHRydWUsCiAgICAgIHRva2VuOiAnJwogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICBzZWFyY2hUeXBlVmFsdWU6IHsKICAgICAgZGVlcDogdHJ1ZSwKICAgICAgaGFuZGxlcihuZXdWYWwsIG9sZFZhbCkgewogICAgICAgIHRoaXMucC5jdXJyZW50ID0gMTsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0VG9rZW4oKSB7CiAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgZ2V0VG9rZW4oKTsKICAgICAgaWYgKHRva2VuKSB7CiAgICAgICAgdGhpcy50b2tlbiA9IHRva2VuOwogICAgICAgIC8vIOWcqOi/memHjOi/m+ihjOWQjue7reaTjeS9nO+8jOWboOS4uuW3sue7j+ehruS/neiOt+WPluWIsOS6hnRva2VuCiAgICAgICAgLy8g5L6L5aaC77yM5oKo5Y+v5Lul5Zyo6L+Z6YeM5omn6KGM5LiK5Lyg5pON5L2c5oiW6ICF5YW25LuW5pON5L2cCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIHRva2VuLicpOwogICAgICB9CiAgICB9LAogICAgLy/ojrflj5blm77niYfnsbvlnosKICAgIGFzeW5jIGdldFBpY1R5cGUoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgbGV0IHsKICAgICAgICAgIHQ6IHJlcwogICAgICAgIH0gPSBhd2FpdCByZXFQaWNUeXBlKCk7CiAgICAgICAgdGhpcy50eXBlT3B0aW9uID0gcmVzOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfQogICAgfSwKICAgIC8v6I635Y+W5omA5pyJ5Zu+54mHCiAgICBhc3luYyBnZXRBbGxQaWMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHJlcUdldEFsbFBpYyh0aGlzLnApOwogICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7CiAgICAgICAgdGhpcy5saXN0ID0gcmVzdWx0LnQubGlzdDsKICAgICAgICB0aGlzLnRvdGFsID0gcmVzdWx0LnQudG90YWw7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9CiAgICB9LAogICAgaGFuZGxlUGljdHVyZUNhcmRQcmV2aWV3KGZpbGUpIHsKICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybCA9IGZpbGUudXJsOwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlOwogICAgfSwKICAgIGhhbmRsZVJlbW92ZShmaWxlLCBmaWxlTGlzdCkgewogICAgICBjb25zb2xlLmxvZyhmaWxlLCBmaWxlTGlzdCk7CiAgICB9LAogICAgaGFuZGxlQ2hhbmdlKGZpbGUpIHsKICAgICAgdGhpcy5maWxlRGF0YS5pbWdOYW1lID0gZmlsZS5uYW1lOwogICAgfSwKICAgIC8v5L+d5a2Y5LiK5Lyg5Zu+54mHCiAgICBzYXZlT3JVcGRhdGUoKSB7CiAgICAgIHRoaXMuJHJlZnMudXBsb2FkLnN1Ym1pdCgpOwogICAgICB0aGlzLkFkZFBpY3R1cmVWaXNpYmxlID0gZmFsc2U7CiAgICAgIGFsZXJ0KCfmt7vliqDmiJDlip8nKTsKICAgICAgdGhpcy5wLmN1cnJlbnQgPSAxOwogICAgICB0aGlzLmdldEFsbFBpYygpOwogICAgICB0aGlzLiRyZWZzLnVwbG9hZC5jbGVhckZpbGVzKCk7IC8v5riF56m65LiK5LiA5qyh55qE5Zu+54mH5YiX6KGoCiAgICAgIHRoaXMuZmlsZURhdGEgPSB7CiAgICAgICAgdGl0bGU6ICcnLAogICAgICAgIHR5cGU6ICcnCiAgICAgIH07IC8v5riF56m65LiK5LiA5qyh55qE5Zu+54mH5L+h5oGvCiAgICAgIHRoaXMuZGlhbG9nSW1hZ2VVcmwgPSAnJzsKICAgIH0sCiAgICAvL+S4iuS8oOmqjOivgQoKICAgIC8v5oyJ57G75Yir5p+l6K+i5Zu+54mHCiAgICBhc3luYyBzZWFyY2hQaWMoKSB7CiAgICAgIGlmICh0aGlzLnNlYXJjaFR5cGVWYWx1ZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgcmVxR2V0VHlwZVBpYyh0aGlzLnNlYXJjaFR5cGVWYWx1ZSwgdGhpcy5wKTsKICAgICAgICAgIHRoaXMubGlzdCA9IHJlc3VsdC5saXN0OwogICAgICAgICAgdGhpcy50b3RhbCA9IHJlc3VsdC50b3RhbDsKICAgICAgICAgIHRoaXMuZmxhZyA9IGZhbHNlOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGFsZXJ0KCLor7fovpPlhaXmn6Xor6LliIbnsbsiKTsKICAgICAgfQogICAgfSwKICAgIC8v5p+l6K+i5YWo6YOo5Zu+54mHCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5zZWFyY2hUeXBlVmFsdWUgPSAiIjsKICAgICAgdGhpcy5wLmN1cnJlbnQgPSAxOwogICAgICB0aGlzLmZsYWcgPSB0cnVlOwogICAgICB0aGlzLmdldEFsbFBpYygpOwogICAgfSwKICAgIC8v5Yig6Zmk5Zu+54mHCiAgICBhc3luYyByZW1vdmVEYXRhQnlJZChpdGVtLCBpbmRleCkgewogICAgICB0cnkgewogICAgICAgIGF3YWl0IHJlcVJlbW92ZVBpYyhpdGVtLmlkLCBpdGVtLmltZ05hbWUpOwogICAgICAgIHRoaXMucC5jdXJyZW50ID0gMTsKICAgICAgICB0aGlzLmdldEFsbFBpYygpOwogICAgICAgIGFsZXJ0KCLliKDpmaTmiJDlip8iKTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0KICAgIH0sCiAgICAvL+WIhumhteWZqOWIh+aNoumhteaVsAogICAgaGFuZGxlQ3VycmVudENoYW5nZShwYWdlcikgewogICAgICB0aGlzLnAuY3VycmVudCA9IHBhZ2VyOwogICAgICBpZiAodGhpcy5mbGFnKSB7CiAgICAgICAgdGhpcy5nZXRBbGxQaWMoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNlYXJjaFBpYygpOwogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5nZXRQaWNUeXBlKCk7CiAgICB0aGlzLmdldEFsbFBpYygpOwogIH0KfTs="},{"version":3,"mappings":"AA8FA;AACA;AACA;AACA;EACAA;EACAC;IACA;MACAC;MAAA;MACAC;MAAA;MACAC;QAAAC;QAAAC;MAAA;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAV;MACAW;MACAC;QACA;MACA;IACA;EACA;EACAC;IACA;MACA;MACA;QACA;QACA;QACA;MACA;QACAC;MACA;IACA;IACA;IACA;MACA;QACA;UAAAC;QAAA;QACA;MACA;QACAD;MACA;IACA;IACA;IACA;MACA;QACA;QACAA;QACA;QACA;MACA;QACAA;MACA;IACA;IACAE;MACA;MACA;IACA;IACAC;MACAH;IACA;IACAI;MACA;IACA;IACA;IACAC;MACA;MACA;MACAC;MACA;MACA;MACA;MACA;QAAAtB;QAAAC;MAAA;MACA;IACA;IACA;;IAEA;IACA;MACA;QACA;UACA;UACA;UACA;UACA;QACA;UACAe;QACA;MACA;QACAM;MACA;IAEA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;IACA;MACA;QACA;QACA;QACA;QACAD;MACA;QACAN;MACA;IACA;IACA;IACAQ;MACA;MACA;QACA;MACA;QACA;MACA;IACA;EACA;EACAC;IACA;IACA;EACA;AACA","names":["name","data","AddPictureVisible","dialogVisible","fileData","title","type","searchTypeValue","dialogImageUrl","typeOption","list","p","current","number","total","flag","token","watch","deep","handler","methods","console","t","handlePictureCardPreview","handleRemove","handleChange","saveOrUpdate","alert","reset","handleCurrentChange","mounted"],"sourceRoot":"src/pages/filedata","sources":["fileDataGainPic.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- 添加轮播图功能 -->\r\n    <el-button  type=\"primary\" size=\"small\" @click=\"AddPictureVisible=true\">添加</el-button>\r\n    <el-dialog title=\"添加\" :visible.sync=\"AddPictureVisible\" :show-close=\"false\" width=\"65%\" >\r\n      <h2 style=\"text-align: center\">添加轮播图</h2>\r\n      <el-form  label-width=\"120px\" style=\"marginTop:15px\">\r\n        <el-form-item label=\"轮播图名称\" prop=\"title\">\r\n          <el-input v-model=\"fileData.title\" placeholder=\"请填写轮播图名称\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"轮播图类型\"  style=\"marginTop:10px;\">\r\n          <el-select v-model=\"fileData.type\" clearable placeholder=\"请选择文章所属类型\" >\r\n            <el-option\r\n              v-for=\"item in typeOption\"\r\n              :key=\"item.id\"\r\n              :label=\"item.type\"\r\n              :value=\"item.id\">\r\n            </el-option>\r\n          </el-select> \r\n        </el-form-item>\r\n        <el-form-item label=\"轮播图素材\">\r\n          <el-upload \r\n            ref=\"upload\" \r\n            :on-preview=\"handlePictureCardPreview\" \r\n            :on-remove=\"handleRemove\" \r\n            :on-change=\"handleChange\" \r\n            :data=\"fileData\" \r\n            :before-upload=\"async () => await this.getToken()\"\r\n            :headers=\"{'Authorization':this.token}\"\r\n            :auto-upload=\"false\" \r\n            class=\"upload-demo\" \r\n            action=\"http://localhost:9108/servicefile/AchievementOfPhoto/upload\" \r\n            list-type=\"picture-card\"\r\n            name=\"file\" \r\n          >\r\n           <!-- 这个有点意思，作者tzh -->\r\n            <i slot=\"default\" class=\"el-icon-plus\" />\r\n          </el-upload>\r\n          <!-- 图片预览放大功能 -->\r\n          <el-dialog :visible.sync=\"dialogVisible\" :modal=\"false\" :center=\"true\" >\r\n            <img :src=\"dialogImageUrl\" width=\"85%\" alt=\"\" />\r\n          </el-dialog> \r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"AddPictureVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveOrUpdate\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n\r\n    <!-- 选择器查询功能 -->\r\n    <template>\r\n      <el-select v-model=\"searchTypeValue\" clearable placeholder=\"请选择分类\"  style=\"marginLeft:10px\" size=\"small\" >\r\n        <el-option\r\n          v-for=\"item in typeOption\"\r\n          :key=\"item.id\"\r\n          :label=\"item.type\"\r\n          :value=\"item.id\">\r\n        </el-option>\r\n      </el-select>\r\n      <el-button type=\"primary\" style=\"marginLeft:10px\" size=\"small\" @click=\"searchPic\"> \r\n          <i class=\"el-icon-search\" style=\"marginright:5px\"></i>查询\r\n      </el-button>\r\n      <el-button style=\"marginLeft:10px\" size=\"small\" @click=\"reset\"> 查询所有</el-button>\r\n    </template>\r\n\r\n    <!-- 列表展示区 -->\r\n    <el-table :data=\"list\" :border=true  style=\"width: 100%;marginTop:15px\" >\r\n      <el-table-column prop=\"title\" label=\"名称\" align=\"center\" />\r\n      <el-table-column prop=\"imgUrl\" label=\"压缩图\" align=\"center\" width=\"300\">\r\n        <template slot-scope=\"scope\">\r\n          <img :src=\"scope.row.imgUrl\" width=\"100\" height=\"80\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"type\" label=\"分类\" align=\"center\" width=\"200\" />\r\n      <el-table-column label=\"操作\" align=\"center\"  width=\"200\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button type=\"danger\" size=\"mini\" icon=\"el-icon-delete\" @click=\"removeDataById(scope.row, scope.$index)\" />\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 分页器 -->\r\n    <el-pagination \r\n        layout=\"prev, pager, next,jumper\" \r\n        :total=\"total\" \r\n        :current-page=\"p.current\" \r\n        :page-size=\"p.number\" \r\n        @current-change=\"handleCurrentChange\">\r\n    </el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n//修改者tzh 2024.3.1\r\nimport {reqPicType,reqGetAllPic,reqGetTypePic,reqRemovePic} from \"@/api/fileData/gainPic\"\r\nimport { getToken } from '@/utils/auth'\r\nexport default {\r\n  name: 'fileDataGainPic',\r\n  data() {\r\n    return {\r\n      AddPictureVisible: false,//添加对话框是否打开\r\n      dialogVisible:false,//图片预览放大功能\r\n      fileData: {title: \"\",type:\"\"},//轮播图信息\r\n      searchTypeValue:\"\",//查询参数\r\n      dialogImageUrl: \"\",//图片URL\r\n      typeOption: [],\r\n      list:[],\r\n      p: {\r\n      current: 1,\r\n      number:4\r\n      },\r\n      total: 0,\r\n      flag:true,\r\n      token: ''\r\n      }\r\n  },\r\n  watch: {\r\n    searchTypeValue:{\r\n      deep: true,\r\n      handler(newVal, oldVal) {\r\n       this.p.current=1\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    async getToken() {\r\n    const token = await getToken();\r\n    if (token) {\r\n        this.token = token;\r\n        // 在这里进行后续操作，因为已经确保获取到了token\r\n        // 例如，您可以在这里执行上传操作或者其他操作\r\n    } else {\r\n        console.error('Failed to fetch token.');\r\n    }\r\n},\r\n    //获取图片类型\r\n    async getPicType() {\r\n      try {\r\n        let { t : res} = await reqPicType()\r\n        this.typeOption = res\r\n      }catch(error){\r\n        console.log(error);\r\n      }\r\n    },\r\n    //获取所有图片\r\n    async getAllPic() {\r\n      try {\r\n        let result = await reqGetAllPic(this.p)\r\n        console.log(result);\r\n        this.list = result.t.list\r\n        this.total = result.t.total\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n    handlePictureCardPreview(file) { \r\n      this.dialogImageUrl = file.url\r\n      this.dialogVisible = true\r\n    },\r\n    handleRemove(file, fileList) { \r\n      console.log(file, fileList)\r\n    },\r\n    handleChange(file) {\r\n      this.fileData.imgName = file.name\r\n    },\r\n    //保存上传图片\r\n    saveOrUpdate() {\r\n      this.$refs.upload.submit()\r\n      this.AddPictureVisible = false\r\n      alert('添加成功')\r\n      this.p.current=1\r\n      this.getAllPic()\r\n      this.$refs.upload.clearFiles()  //清空上一次的图片列表\r\n      this.fileData = { title: '', type: '' }     //清空上一次的图片信息\r\n      this.dialogImageUrl=''\r\n    },\r\n    //上传验证\r\n    \r\n    //按类别查询图片\r\n    async searchPic() { \r\n      if (this.searchTypeValue) {\r\n        try {\r\n        let result = await reqGetTypePic(this.searchTypeValue, this.p)\r\n        this.list = result.list\r\n        this.total = result.total\r\n        this.flag=false\r\n      } catch (error) {\r\n        console.log(error);\r\n      }  \r\n      } else {\r\n        alert(\"请输入查询分类\")\r\n      }\r\n      \r\n    },\r\n    //查询全部图片\r\n    reset() {\r\n      this.searchTypeValue = \"\"\r\n      this.p.current = 1\r\n      this.flag=true\r\n      this.getAllPic()\r\n    },\r\n    //删除图片\r\n    async removeDataById(item,index) { \r\n      try {\r\n        await reqRemovePic(item.id, item.imgName)\r\n        this.p.current = 1\r\n        this.getAllPic()\r\n        alert(\"删除成功\")\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n    //分页器切换页数\r\n    handleCurrentChange(pager) {\r\n      this.p.current = pager\r\n      if (this.flag) {\r\n        this.getAllPic()\r\n      } else {\r\n        this.searchPic()\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getPicType()\r\n    this.getAllPic()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.cell{\r\n  text-align: center;\r\n}\r\n\r\n::v-deep  .el-pagination{\r\n  position: absolute;\r\n  top: 650px;\r\n  left: 45%;\r\n}\r\n</style>"]}]}