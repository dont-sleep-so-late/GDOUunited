{"remainingRequest":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\src\\pages\\filedata\\fileDataGainPic.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\src\\pages\\filedata\\fileDataGainPic.vue","mtime":1711121721550},{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710918915895},{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\babel-loader\\lib\\index.js","mtime":1710918914227},{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1710918915895},{"path":"C:\\Users\\DIO\\Desktop\\云统战\\GDOUunited\\node_modules\\vue-loader\\lib\\index.js","mtime":1710918931244}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQovL+S/ruaUueiAhXR6aCAyMDI0LjMuMQ0KaW1wb3J0IHtyZXFQaWNUeXBlLHJlcUdldEFsbFBpYyxyZXFHZXRUeXBlUGljLHJlcVJlbW92ZVBpY30gZnJvbSAiQC9hcGkvZmlsZURhdGEvZ2FpblBpYyINCmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnQC91dGlscy9hdXRoJw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnZmlsZURhdGFHYWluUGljJywNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgQWRkUGljdHVyZVZpc2libGU6IGZhbHNlLC8v5re75Yqg5a+56K+d5qGG5piv5ZCm5omT5byADQogICAgICBkaWFsb2dWaXNpYmxlOmZhbHNlLC8v5Zu+54mH6aKE6KeI5pS+5aSn5Yqf6IO9DQogICAgICBmaWxlRGF0YToge3RpdGxlOiAiIix0eXBlOiIifSwvL+i9ruaSreWbvuS/oeaBrw0KICAgICAgc2VhcmNoVHlwZVZhbHVlOiIiLC8v5p+l6K+i5Y+C5pWwDQogICAgICBkaWFsb2dJbWFnZVVybDogIiIsLy/lm77niYdVUkwNCiAgICAgIHR5cGVPcHRpb246IFtdLA0KICAgICAgbGlzdDpbXSwNCiAgICAgIHA6IHsNCiAgICAgIGN1cnJlbnQ6IDEsDQogICAgICBudW1iZXI6NA0KICAgICAgfSwNCiAgICAgIHRvdGFsOiAwLA0KICAgICAgZmxhZzp0cnVlLA0KICAgICAgdG9rZW46ICcnDQogICAgICB9DQogIH0sDQogIHdhdGNoOiB7DQogICAgc2VhcmNoVHlwZVZhbHVlOnsNCiAgICAgIGRlZXA6IHRydWUsDQogICAgICBoYW5kbGVyKG5ld1ZhbCwgb2xkVmFsKSB7DQogICAgICAgdGhpcy5wLmN1cnJlbnQ9MQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGFzeW5jIGdldFRva2VuKCkgew0KICAgIGNvbnN0IHRva2VuID0gYXdhaXQgZ2V0VG9rZW4oKTsNCiAgICBpZiAodG9rZW4pIHsNCiAgICAgICAgdGhpcy50b2tlbiA9IHRva2VuOw0KICAgICAgICAvLyDlnKjov5nph4zov5vooYzlkI7nu63mk43kvZzvvIzlm6DkuLrlt7Lnu4/noa7kv53ojrflj5bliLDkuoZ0b2tlbg0KICAgICAgICAvLyDkvovlpoLvvIzmgqjlj6/ku6XlnKjov5nph4zmiafooYzkuIrkvKDmk43kvZzmiJbogIXlhbbku5bmk43kvZwNCiAgICB9IGVsc2Ugew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggdG9rZW4uJyk7DQogICAgfQ0KfSwNCiAgICAvL+iOt+WPluWbvueJh+exu+Weiw0KICAgIGFzeW5jIGdldFBpY1R5cGUoKSB7DQogICAgICB0cnkgew0KICAgICAgICBsZXQgeyB0IDogcmVzfSA9IGF3YWl0IHJlcVBpY1R5cGUoKQ0KICAgICAgICB0aGlzLnR5cGVPcHRpb24gPSByZXMNCiAgICAgIH1jYXRjaChlcnJvcil7DQogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8v6I635Y+W5omA5pyJ5Zu+54mHDQogICAgYXN5bmMgZ2V0QWxsUGljKCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHJlcUdldEFsbFBpYyh0aGlzLnApDQogICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7DQogICAgICAgIHRoaXMubGlzdCA9IHJlc3VsdC50Lmxpc3QNCiAgICAgICAgdGhpcy50b3RhbCA9IHJlc3VsdC50LnRvdGFsDQogICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7DQogICAgICB9DQogICAgfSwNCiAgICBoYW5kbGVQaWN0dXJlQ2FyZFByZXZpZXcoZmlsZSkgeyANCiAgICAgIHRoaXMuZGlhbG9nSW1hZ2VVcmwgPSBmaWxlLnVybA0KICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZQ0KICAgIH0sDQogICAgaGFuZGxlUmVtb3ZlKGZpbGUsIGZpbGVMaXN0KSB7IA0KICAgICAgY29uc29sZS5sb2coZmlsZSwgZmlsZUxpc3QpDQogICAgfSwNCiAgICBoYW5kbGVDaGFuZ2UoZmlsZSkgew0KICAgICAgdGhpcy5maWxlRGF0YS5pbWdOYW1lID0gZmlsZS5uYW1lDQogICAgfSwNCiAgICAvL+S/neWtmOS4iuS8oOWbvueJhw0KICAgIHNhdmVPclVwZGF0ZSgpIHsNCiAgICAgIHRoaXMuJHJlZnMudXBsb2FkLnN1Ym1pdCgpDQogICAgICB0aGlzLkFkZFBpY3R1cmVWaXNpYmxlID0gZmFsc2UNCiAgICAgIGFsZXJ0KCfmt7vliqDmiJDlip8nKQ0KICAgICAgdGhpcy5wLmN1cnJlbnQ9MQ0KICAgICAgdGhpcy5nZXRBbGxQaWMoKQ0KICAgICAgdGhpcy4kcmVmcy51cGxvYWQuY2xlYXJGaWxlcygpICAvL+a4heepuuS4iuS4gOasoeeahOWbvueJh+WIl+ihqA0KICAgICAgdGhpcy5maWxlRGF0YSA9IHsgdGl0bGU6ICcnLCB0eXBlOiAnJyB9ICAgICAvL+a4heepuuS4iuS4gOasoeeahOWbvueJh+S/oeaBrw0KICAgICAgdGhpcy5kaWFsb2dJbWFnZVVybD0nJw0KICAgIH0sDQogICAgLy/kuIrkvKDpqozor4ENCiAgICANCiAgICAvL+aMieexu+WIq+afpeivouWbvueJhw0KICAgIGFzeW5jIHNlYXJjaFBpYygpIHsgDQogICAgICBpZiAodGhpcy5zZWFyY2hUeXBlVmFsdWUpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHJlcUdldFR5cGVQaWModGhpcy5zZWFyY2hUeXBlVmFsdWUsIHRoaXMucCkNCiAgICAgICAgdGhpcy5saXN0ID0gcmVzdWx0Lmxpc3QNCiAgICAgICAgdGhpcy50b3RhbCA9IHJlc3VsdC50b3RhbA0KICAgICAgICB0aGlzLmZsYWc9ZmFsc2UNCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsNCiAgICAgIH0gIA0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgYWxlcnQoIuivt+i+k+WFpeafpeivouWIhuexuyIpDQogICAgICB9DQogICAgICANCiAgICB9LA0KICAgIC8v5p+l6K+i5YWo6YOo5Zu+54mHDQogICAgcmVzZXQoKSB7DQogICAgICB0aGlzLnNlYXJjaFR5cGVWYWx1ZSA9ICIiDQogICAgICB0aGlzLnAuY3VycmVudCA9IDENCiAgICAgIHRoaXMuZmxhZz10cnVlDQogICAgICB0aGlzLmdldEFsbFBpYygpDQogICAgfSwNCiAgICAvL+WIoOmZpOWbvueJhw0KICAgIGFzeW5jIHJlbW92ZURhdGFCeUlkKGl0ZW0saW5kZXgpIHsgDQogICAgICB0cnkgew0KICAgICAgICBhd2FpdCByZXFSZW1vdmVQaWMoaXRlbS5pZCwgaXRlbS5pbWdOYW1lKQ0KICAgICAgICB0aGlzLnAuY3VycmVudCA9IDENCiAgICAgICAgdGhpcy5nZXRBbGxQaWMoKQ0KICAgICAgICBhbGVydCgi5Yig6Zmk5oiQ5YqfIikNCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8v5YiG6aG15Zmo5YiH5o2i6aG15pWwDQogICAgaGFuZGxlQ3VycmVudENoYW5nZShwYWdlcikgew0KICAgICAgdGhpcy5wLmN1cnJlbnQgPSBwYWdlcg0KICAgICAgaWYgKHRoaXMuZmxhZykgew0KICAgICAgICB0aGlzLmdldEFsbFBpYygpDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLnNlYXJjaFBpYygpDQogICAgICB9DQogICAgfQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuZ2V0UGljVHlwZSgpDQogICAgdGhpcy5nZXRBbGxQaWMoKQ0KICB9DQp9DQo="},{"version":3,"sources":["fileDataGainPic.vue"],"names":[],"mappings":";AA8FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"fileDataGainPic.vue","sourceRoot":"src/pages/filedata","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 添加轮播图功能 -->\r\n    <el-button  type=\"primary\" size=\"small\" @click=\"AddPictureVisible=true\">添加</el-button>\r\n    <el-dialog title=\"添加\" :visible.sync=\"AddPictureVisible\" :show-close=\"false\" width=\"65%\" >\r\n      <h2 style=\"text-align: center\">添加轮播图</h2>\r\n      <el-form  label-width=\"120px\" style=\"marginTop:15px\">\r\n        <el-form-item label=\"轮播图名称\" prop=\"title\">\r\n          <el-input v-model=\"fileData.title\" placeholder=\"请填写轮播图名称\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"轮播图类型\"  style=\"marginTop:10px;\">\r\n          <el-select v-model=\"fileData.type\" clearable placeholder=\"请选择文章所属类型\" >\r\n            <el-option\r\n              v-for=\"item in typeOption\"\r\n              :key=\"item.id\"\r\n              :label=\"item.type\"\r\n              :value=\"item.id\">\r\n            </el-option>\r\n          </el-select> \r\n        </el-form-item>\r\n        <el-form-item label=\"轮播图素材\">\r\n          <el-upload \r\n            ref=\"upload\" \r\n            :on-preview=\"handlePictureCardPreview\" \r\n            :on-remove=\"handleRemove\" \r\n            :on-change=\"handleChange\" \r\n            :data=\"fileData\" \r\n            :before-upload=\"async () => await this.getToken()\"\r\n            :headers=\"{'Authorization':this.token}\"\r\n            :auto-upload=\"false\" \r\n            class=\"upload-demo\" \r\n            action=\"http://localhost:9108/servicefile/AchievementOfPhoto/upload\" \r\n            list-type=\"picture-card\"\r\n            name=\"file\" \r\n          >\r\n           <!-- 这个有点意思，作者tzh -->\r\n            <i slot=\"default\" class=\"el-icon-plus\" />\r\n          </el-upload>\r\n          <!-- 图片预览放大功能 -->\r\n          <el-dialog :visible.sync=\"dialogVisible\" :modal=\"false\" :center=\"true\" >\r\n            <img :src=\"dialogImageUrl\" width=\"85%\" alt=\"\" />\r\n          </el-dialog> \r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"AddPictureVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveOrUpdate\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n\r\n    <!-- 选择器查询功能 -->\r\n    <template>\r\n      <el-select v-model=\"searchTypeValue\" clearable placeholder=\"请选择分类\"  style=\"marginLeft:10px\" size=\"small\" >\r\n        <el-option\r\n          v-for=\"item in typeOption\"\r\n          :key=\"item.id\"\r\n          :label=\"item.type\"\r\n          :value=\"item.id\">\r\n        </el-option>\r\n      </el-select>\r\n      <el-button type=\"primary\" style=\"marginLeft:10px\" size=\"small\" @click=\"searchPic\"> \r\n          <i class=\"el-icon-search\" style=\"marginright:5px\"></i>查询\r\n      </el-button>\r\n      <el-button style=\"marginLeft:10px\" size=\"small\" @click=\"reset\"> 查询所有</el-button>\r\n    </template>\r\n\r\n    <!-- 列表展示区 -->\r\n    <el-table :data=\"list\" :border=true  style=\"width: 100%;marginTop:15px\" >\r\n      <el-table-column prop=\"title\" label=\"名称\" align=\"center\" />\r\n      <el-table-column prop=\"imgUrl\" label=\"压缩图\" align=\"center\" width=\"300\">\r\n        <template slot-scope=\"scope\">\r\n          <img :src=\"scope.row.imgUrl\" width=\"100\" height=\"80\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"type\" label=\"分类\" align=\"center\" width=\"200\" />\r\n      <el-table-column label=\"操作\" align=\"center\"  width=\"200\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button type=\"danger\" size=\"mini\" icon=\"el-icon-delete\" @click=\"removeDataById(scope.row, scope.$index)\" />\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 分页器 -->\r\n    <el-pagination \r\n        layout=\"prev, pager, next,jumper\" \r\n        :total=\"total\" \r\n        :current-page=\"p.current\" \r\n        :page-size=\"p.number\" \r\n        @current-change=\"handleCurrentChange\">\r\n    </el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n//修改者tzh 2024.3.1\r\nimport {reqPicType,reqGetAllPic,reqGetTypePic,reqRemovePic} from \"@/api/fileData/gainPic\"\r\nimport { getToken } from '@/utils/auth'\r\nexport default {\r\n  name: 'fileDataGainPic',\r\n  data() {\r\n    return {\r\n      AddPictureVisible: false,//添加对话框是否打开\r\n      dialogVisible:false,//图片预览放大功能\r\n      fileData: {title: \"\",type:\"\"},//轮播图信息\r\n      searchTypeValue:\"\",//查询参数\r\n      dialogImageUrl: \"\",//图片URL\r\n      typeOption: [],\r\n      list:[],\r\n      p: {\r\n      current: 1,\r\n      number:4\r\n      },\r\n      total: 0,\r\n      flag:true,\r\n      token: ''\r\n      }\r\n  },\r\n  watch: {\r\n    searchTypeValue:{\r\n      deep: true,\r\n      handler(newVal, oldVal) {\r\n       this.p.current=1\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    async getToken() {\r\n    const token = await getToken();\r\n    if (token) {\r\n        this.token = token;\r\n        // 在这里进行后续操作，因为已经确保获取到了token\r\n        // 例如，您可以在这里执行上传操作或者其他操作\r\n    } else {\r\n        console.error('Failed to fetch token.');\r\n    }\r\n},\r\n    //获取图片类型\r\n    async getPicType() {\r\n      try {\r\n        let { t : res} = await reqPicType()\r\n        this.typeOption = res\r\n      }catch(error){\r\n        console.log(error);\r\n      }\r\n    },\r\n    //获取所有图片\r\n    async getAllPic() {\r\n      try {\r\n        let result = await reqGetAllPic(this.p)\r\n        console.log(result);\r\n        this.list = result.t.list\r\n        this.total = result.t.total\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n    handlePictureCardPreview(file) { \r\n      this.dialogImageUrl = file.url\r\n      this.dialogVisible = true\r\n    },\r\n    handleRemove(file, fileList) { \r\n      console.log(file, fileList)\r\n    },\r\n    handleChange(file) {\r\n      this.fileData.imgName = file.name\r\n    },\r\n    //保存上传图片\r\n    saveOrUpdate() {\r\n      this.$refs.upload.submit()\r\n      this.AddPictureVisible = false\r\n      alert('添加成功')\r\n      this.p.current=1\r\n      this.getAllPic()\r\n      this.$refs.upload.clearFiles()  //清空上一次的图片列表\r\n      this.fileData = { title: '', type: '' }     //清空上一次的图片信息\r\n      this.dialogImageUrl=''\r\n    },\r\n    //上传验证\r\n    \r\n    //按类别查询图片\r\n    async searchPic() { \r\n      if (this.searchTypeValue) {\r\n        try {\r\n        let result = await reqGetTypePic(this.searchTypeValue, this.p)\r\n        this.list = result.list\r\n        this.total = result.total\r\n        this.flag=false\r\n      } catch (error) {\r\n        console.log(error);\r\n      }  \r\n      } else {\r\n        alert(\"请输入查询分类\")\r\n      }\r\n      \r\n    },\r\n    //查询全部图片\r\n    reset() {\r\n      this.searchTypeValue = \"\"\r\n      this.p.current = 1\r\n      this.flag=true\r\n      this.getAllPic()\r\n    },\r\n    //删除图片\r\n    async removeDataById(item,index) { \r\n      try {\r\n        await reqRemovePic(item.id, item.imgName)\r\n        this.p.current = 1\r\n        this.getAllPic()\r\n        alert(\"删除成功\")\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    },\r\n    //分页器切换页数\r\n    handleCurrentChange(pager) {\r\n      this.p.current = pager\r\n      if (this.flag) {\r\n        this.getAllPic()\r\n      } else {\r\n        this.searchPic()\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getPicType()\r\n    this.getAllPic()\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.cell{\r\n  text-align: center;\r\n}\r\n\r\n::v-deep  .el-pagination{\r\n  position: absolute;\r\n  top: 650px;\r\n  left: 45%;\r\n}\r\n</style>"]}]}